language: node_js

node_js: node

cache: npm

install:
    - npm install --global yarn
    - yarn install --non-interactive --production false
    - export PATH=$PATH:$TRAVIS_BUILD_DIR/node_modules/.bin

script:
    - sassdoc src
    - node-sass --follow --output src src
    - find src -name "*.css" -exec postcss {} --map --replace \;
    - if GIT_DIR=$TRAVIS_BUILD_DIR.git git rev-parse $1>/dev/null 2>&1; then npm version from-git; fi

deploy:
    - provider: npm
      email: richiebendall@gmail.com
      skip_cleanup: true
      api_key: $npm_token
      on:
          tags: true
          repo: Richienb/ros-css-styles-toolkit

    - provider: pages
      skip-cleanup: true
      github-token: $github_token
      keep-history: true
      local-dir: $TRAVIS_BUILD_DIR/sassdoc
      committer-from-gh: true
      on:
           branch: master
